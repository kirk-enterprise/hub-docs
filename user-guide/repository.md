# 3.2 仓库管理
仓库管理是用户镜像仓库的管理中心，管理两类镜像仓库：    
1. 非持续构建镜像仓库：仓库下的镜像只能通过docker push的方式进行推送    
2. 持续构建镜像仓库：仓库下镜像除了可以通过docker push进行推送，还可以配置镜像自动构建流程

## 3.2.1 仓库管理主页面
登录七牛云镜像中心控制台，点击左侧导航菜单的「镜像仓库」，进入仓库管理中心：

![镜像仓库管理主页面](_figures/user-guide/user-repo-mgr.png)

你可以在「镜像仓库」主界面进行如下操作：    
1.点击「创建新的仓库」创建一个新的镜像仓库    
2.查看镜像仓库基本信息，如仓库名称、仓库创建时间、仓库地址、仓库类型等   
3.点击「上传镜像」查看如何从本地推动镜像到镜像仓库    
4.点击「拉取镜像」查看如何从镜像仓库拉取镜像到本地    
5.通过切换标签「收藏夹」，显示在镜像中心收藏的镜像（如何收藏镜像）。  
6.点击「管理」进入到仓库二级页面，对仓库进行操作，如版本管理、持续构建、webhook、仓库信息修改等    

## 3.2.2 创建仓库

### 非持续构建镜像仓库
1.登录 控制台，定位「镜像仓库」标签    
2.在镜像仓库列表左上角，点击「创建新的仓库」按钮，开始填写镜像仓库信息    
3.填写「仓库名称」

?> **名称要求：**2-64位的小写字母、数字、分隔符("-"、"_"、".")，分隔符不能为开头  

!> **注意：仓库一旦创建成功，名称将无法修改**    

4.填写「摘要」    
5.填写「详情」，可选择不填    
6.勾选「镜像类型」    
7.关闭「持续构建」     
8.点击「创建」  

![创建新的仓库](_figures/user-guide/repo-create.png)

### 持续构建镜像仓库
仓库信息部分的填写可以参考「非持续构建镜像仓库」，流程一样。持续构建镜像仓库需要开启「持续构建」。开启后，用户首先要「关联Github账号」。

![创建新的仓库](_figures/user-guide/repo-create-code.png)

1.点击「关联Github账号」，用户登陆Github，在Github端做平台授权

![创建新的仓库](_figures/user-guide/user-repo-auth.png)

2.授权后，就完成了平台和Github账号的关联。下拉选择Github Project，点击「新增构建规则」为仓库添加镜像持续构建规则，一个镜像仓库可以有多条构建规则。

?> **类型：**选择该条规则的触发类型，可以是Github Project的「branch」或者「tag」   
   **名称：**「branch」类型下拉选择branch名，「tag」类型可以选择下拉已存在的tag号，也可以填写通配符    
   **Dockerfile文件：**下拉选择Dockerfile文件
   **版本号：**镜像构建后的版本名称        
   **版本覆盖：**「开启」，则最新构建的镜像版本将覆盖历史版本，版本名称为「版本号」。「关闭」，则所有构建的镜像版本将并存，版本名称为「版本号」+github commit前7位
       
3.点击「创建」，完成仓库创建   

![创建新的仓库](_figures/user-guide/user-repo-github.png)

## 3.2.3 管理仓库
仓库管理分四个Tab - 「镜像版本」「持续构建」「webhook」「基本信息」

### 镜像版本
这里用来管理当前仓库下的所有镜像版本，可以做的操作如下：    
1.点击「备注」可以为某个镜像版本添加备注名称    
2.点击「拉取」复制某个镜像版本的拉取命令

![创建新的仓库](_figures/user-guide/user-repo-tag.png)

### 持续构建
这里用来管理当前仓库的持续构建规则以及查看持续构建记录，可以做的操作如下：    
**设置 -**        
1.点击「新建」创建一条新的规则    
2.点击「立即构建」触发当前规则的手动构建   
3.点击「修改」对当前规则进行编辑    
4.点击「删除」将当前规则删除    

**构建记录 -**    
1.点击「日志」查看该条构建记录的构建日志，用于问题的定位

?> **状态：**包含成功 / 构建中 / 失败 三种状态    
            
![创建新的仓库](_figures/user-guide/user-repo-build.png)

### Webhook
这里用来管理当前仓库的webhook调度规则以及访问记录，可以做的操作如下：    
1.点击「新建」创建一条新的webhook调度规则    
2.点击「删除」将当前规则删除    
3.点击「访问记录」查看当前规则的历史调度记录    

![创建新的仓库](_figures/user-guide/user-repo-webhook.png)

![创建新的仓库](_figures/user-guide/user-repo-webhook-test.png)

### 基本信息
这里用来管理当前仓库的基本信息，可以做的操作如下：    
1.点击「编辑」对当前仓库进行修改，可以修改的信息为「摘要」「详情」「镜像类型」    

![创建新的仓库](_figures/user-guide/user-repo-basic.png)